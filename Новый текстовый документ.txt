using System;
using System.Collections.Generic;

namespace lab2
{
    internal class Program
    {
        class Radio
        {
            private bool _state = false;
            public void On() => _state = true;
            public void Off() => _state = false;
            public bool Status() => _state;
        }

        class Car
        {
            private string _name;
            private double _speed = 0;
            private bool _started = false;
            private double _maxspeed;
            private Radio radio;

            public Car(string name, double maxspeed)
            {
                radio = new Radio();
                _name = name;
                _maxspeed = maxspeed;
            }

            public string GetName() => _name;

            public void Start()
            {
                _started = true;
                Console.WriteLine($"\n[!] {_name} заведена.");
            }

            public void Stop()
            {
                _started = false;
                _speed = 0;
                Console.WriteLine($"\n[!] {_name} заглушена.");
            }

            public void Speedup(double value)
            {
                if (!_started) { Console.WriteLine("Сначала заведи машину!"); return; }

                if (value <= _maxspeed)
                {
                    while (_speed < value - 6)
                    {
                        _speed += 6;
                        Console.WriteLine($"{_speed} Km/h / {_name}");
                    }
                    _speed = value;
                    Console.WriteLine($"{_speed} Km/h / {_name} (Цель достигнута)");
                }
                else
                {
                    Console.WriteLine($"Движок говно у {_name}, максимум: {_maxspeed}");
                }
            }

            public void Slowdown(double value)
            {
                if (value < 0) value = 0;
                while (value < _speed - 6)
                {
                    _speed -= 6;
                    Console.WriteLine($"{_speed} Km/h / {_name}");
                }
                _speed = value;
                Console.WriteLine($"{_speed} Km/h / {_name} (Замедлились)");
            }

            public void Radio_On() => radio.On();
            public void Radio_Off() => radio.Off();
            public void Radio_Status()
            {
                string status = radio.Status() ? "Включено" : "Выключено";
                Console.WriteLine($"Радио в {_name}: {status}");
            }
        }

        // Наследники
        class Toyota : Car { public Toyota(string name, double v) : base(name, v) { } }
        class Buggatti : Car { public Buggatti(string name, double v) : base(name, v) { } }
        class Lada : Car { public Lada(string name, double v) : base(name, v) { } }

        static void Main(string[] args)
        {
            // Список доступных машин
            List<Car> garage = new List<Car>
            {
                new Toyota("Probox", 180),
                new Buggatti("Veyron", 420),
                new Lada("Vesta", 160)
            };

            while (true)
            {
                Console.Clear();
                Console.WriteLine("=== ВЫБЕРИТЕ АВТОМОБИЛЬ ===");
                for (int i = 0; i < garage.Count; i++)
                {
                    Console.WriteLine($"{i + 1}. {garage[i].GetName()}");
                }
                Console.WriteLine("0. Выход");

                if (!int.TryParse(Console.ReadLine(), out int carChoice) || carChoice == 0) break;
                if (carChoice > garage.Count) continue;

                Car selectedCar = garage[carChoice - 1];
                bool backToGarage = false;

                // Меню функций машины
                while (!backToGarage)
                {
                    Console.WriteLine($"\n--- Управление: {selectedCar.GetName()} ---");
                    Console.WriteLine("1. Завести");
                    Console.WriteLine("2. Разогнаться");
                    Console.WriteLine("3. Притормозить");
                    Console.WriteLine("4. Вкл/Выкл Радио");
                    Console.WriteLine("5. Статус Радио");
                    Console.WriteLine("6. Заглушить");
                    Console.WriteLine("0. Вернуться в гараж");
                    Console.Write("Выбор: ");

                    string action = Console.ReadLine();
                    switch (action)
                    {
                        case "1": selectedCar.Start(); break;
                        case "2":
                            Console.Write("Введите скорость: ");
                            double.TryParse(Console.ReadLine(), out double s);
                            selectedCar.Speedup(s);
                            break;
                        case "3":
                            Console.Write("До какой снизить: ");
                            double.TryParse(Console.ReadLine(), out double slow);
                            selectedCar.Slowdown(slow);
                            break;
                        case "4":
                            // Переключалка
                            selectedCar.Radio_On(); 
                            Console.WriteLine("Радио включено.");
                            break;
                        case "5": selectedCar.Radio_Status(); break;
                        case "6": selectedCar.Stop(); break;
                        case "0": backToGarage = true; break;
                        default: Console.WriteLine("Неверный ввод"); break;
                    }
                }
            }
        }
    }
}
